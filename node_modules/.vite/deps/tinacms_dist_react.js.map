{
  "version": 3,
  "sources": ["../../tinacms/dist/react.js"],
  "sourcesContent": ["import React from \"react\";\nfunction useTina(props) {\n  const stringifiedQuery = JSON.stringify({\n    query: props.query,\n    variables: props.variables\n  });\n  const id = React.useMemo(\n    () => hashFromQuery(stringifiedQuery),\n    [stringifiedQuery]\n  );\n  const processedData = React.useMemo(() => {\n    if (props.data) {\n      const dataCopy = JSON.parse(JSON.stringify(props.data));\n      return addMetadata(id, dataCopy, []);\n    }\n  }, [props.data, id]);\n  const [data, setData] = React.useState(processedData);\n  const [isClient, setIsClient] = React.useState(false);\n  const [quickEditEnabled, setQuickEditEnabled] = React.useState(false);\n  const [isInTinaIframe, setIsInTinaIframe] = React.useState(false);\n  React.useEffect(() => {\n    setIsClient(true);\n    setData(processedData);\n    parent.postMessage({\n      type: \"url-changed\"\n    });\n  }, [id, processedData]);\n  React.useEffect(() => {\n    if (quickEditEnabled) {\n      let mouseDownHandler = function(e) {\n        const attributeNames = e.target.getAttributeNames();\n        const tinaAttribute = attributeNames.find(\n          (name) => name.startsWith(\"data-tina-field\")\n        );\n        let fieldName;\n        if (tinaAttribute) {\n          e.preventDefault();\n          e.stopPropagation();\n          fieldName = e.target.getAttribute(tinaAttribute);\n        } else {\n          const ancestor = e.target.closest(\n            \"[data-tina-field], [data-tina-field-overlay]\"\n          );\n          if (ancestor) {\n            const attributeNames2 = ancestor.getAttributeNames();\n            const tinaAttribute2 = attributeNames2.find(\n              (name) => name.startsWith(\"data-tina-field\")\n            );\n            if (tinaAttribute2) {\n              e.preventDefault();\n              e.stopPropagation();\n              fieldName = ancestor.getAttribute(tinaAttribute2);\n            }\n          }\n        }\n        if (fieldName) {\n          if (isInTinaIframe) {\n            parent.postMessage(\n              { type: \"field:selected\", fieldName },\n              window.location.origin\n            );\n          }\n        }\n      };\n      const style = document.createElement(\"style\");\n      style.type = \"text/css\";\n      style.textContent = `\n        [data-tina-field] {\n          outline: 2px dashed rgba(34,150,254,0.5);\n          transition: box-shadow ease-out 150ms;\n        }\n        [data-tina-field]:hover {\n          box-shadow: inset 100vi 100vh rgba(34,150,254,0.3);\n          outline: 2px solid rgba(34,150,254,1);\n          cursor: pointer;\n        }\n        [data-tina-field-overlay] {\n          outline: 2px dashed rgba(34,150,254,0.5);\n          position: relative;\n        }\n        [data-tina-field-overlay]:hover {\n          cursor: pointer;\n          outline: 2px solid rgba(34,150,254,1);\n        }\n        [data-tina-field-overlay]::after {\n          content: '';\n          position: absolute;\n          inset: 0;\n          z-index: 20;\n          transition: opacity ease-out 150ms;\n          background-color: rgba(34,150,254,0.3);\n          opacity: 0;\n        }\n        [data-tina-field-overlay]:hover::after {\n          opacity: 1;\n        }\n      `;\n      document.head.appendChild(style);\n      document.body.classList.add(\"__tina-quick-editing-enabled\");\n      document.addEventListener(\"click\", mouseDownHandler, true);\n      return () => {\n        document.removeEventListener(\"click\", mouseDownHandler, true);\n        document.body.classList.remove(\"__tina-quick-editing-enabled\");\n        style.remove();\n      };\n    }\n  }, [quickEditEnabled, isInTinaIframe]);\n  React.useEffect(() => {\n    if (props == null ? void 0 : props.experimental___selectFormByFormId) {\n      parent.postMessage({\n        type: \"user-select-form\",\n        formId: props.experimental___selectFormByFormId()\n      });\n    }\n  }, [id]);\n  React.useEffect(() => {\n    const { experimental___selectFormByFormId, ...rest } = props;\n    parent.postMessage({ type: \"open\", ...rest, id }, window.location.origin);\n    const handleMessage = (event) => {\n      if (event.data.type === \"quickEditEnabled\") {\n        setQuickEditEnabled(event.data.value);\n      }\n      if (event.data.id === id && event.data.type === \"updateData\") {\n        const rawData = event.data.data;\n        const newlyProcessedData = addMetadata(\n          id,\n          JSON.parse(JSON.stringify(rawData)),\n          []\n        );\n        setData(newlyProcessedData);\n        setIsInTinaIframe(true);\n        const anyTinaField = document.querySelector(\"[data-tina-field]\");\n        if (anyTinaField) {\n          parent.postMessage(\n            { type: \"quick-edit\", value: true },\n            window.location.origin\n          );\n        } else {\n          parent.postMessage(\n            { type: \"quick-edit\", value: false },\n            window.location.origin\n          );\n        }\n      }\n    };\n    window.addEventListener(\"message\", handleMessage);\n    return () => {\n      window.removeEventListener(\"message\", handleMessage);\n      parent.postMessage({ type: \"close\", id }, window.location.origin);\n    };\n  }, [id, setQuickEditEnabled]);\n  return { data, isClient };\n}\nfunction useEditState() {\n  const [edit, setEdit] = React.useState(false);\n  React.useEffect(() => {\n    if (typeof window !== \"undefined\") {\n      parent.postMessage({ type: \"isEditMode\" }, window.location.origin);\n      window.addEventListener(\"message\", (event) => {\n        var _a;\n        if (((_a = event.data) == null ? void 0 : _a.type) === \"tina:editMode\") {\n          setEdit(true);\n        }\n      });\n    }\n  }, []);\n  return { edit };\n}\nconst tinaField = (object, property, index) => {\n  const contentSource = object == null ? void 0 : object._content_source;\n  if (!contentSource) {\n    return \"\";\n  }\n  const { queryId, path } = contentSource;\n  if (!property) {\n    return `${queryId}---${path.join(\".\")}`;\n  }\n  const fullPath = typeof index === \"number\" ? [...path, property, index] : [...path, property];\n  return `${queryId}---${fullPath.join(\".\")}`;\n};\nconst addMetadata = (id, obj, path = []) => {\n  if (obj === null) {\n    return obj;\n  }\n  if (isScalarOrUndefined(obj)) {\n    return obj;\n  }\n  if (obj instanceof String) {\n    return obj.valueOf();\n  }\n  if (Array.isArray(obj)) {\n    return obj.map(\n      (item, index) => addMetadata(id, item, [...path, index])\n    );\n  }\n  const transformedObj = {};\n  for (const [key, value] of Object.entries(obj)) {\n    const currentPath = [...path, key];\n    if ([\n      \"__typename\",\n      \"_sys\",\n      \"_internalSys\",\n      \"_values\",\n      \"_internalValues\",\n      \"_content_source\",\n      \"_tina_metadata\"\n    ].includes(key)) {\n      transformedObj[key] = value;\n    } else {\n      transformedObj[key] = addMetadata(id, value, currentPath);\n    }\n  }\n  if (transformedObj && typeof transformedObj === \"object\" && \"type\" in transformedObj && transformedObj.type === \"root\") {\n    return transformedObj;\n  }\n  return { ...transformedObj, _content_source: { queryId: id, path } };\n};\nfunction isScalarOrUndefined(value) {\n  const type = typeof value;\n  if (type === \"string\")\n    return true;\n  if (type === \"number\")\n    return true;\n  if (type === \"boolean\")\n    return true;\n  if (type === \"undefined\")\n    return true;\n  if (value == null)\n    return true;\n  if (value instanceof String)\n    return true;\n  if (value instanceof Number)\n    return true;\n  if (value instanceof Boolean)\n    return true;\n  return false;\n}\nconst hashFromQuery = (input) => {\n  let hash = 0;\n  for (let i = 0; i < input.length; i++) {\n    const char = input.charCodeAt(i);\n    hash = (hash << 5) - hash + char & 4294967295;\n  }\n  const nonNegativeHash = Math.abs(hash);\n  const alphanumericHash = nonNegativeHash.toString(36);\n  return alphanumericHash;\n};\nexport {\n  addMetadata,\n  hashFromQuery,\n  tinaField,\n  useEditState,\n  useTina\n};\n"],
  "mappings": ";;;;;;AAAA,mBAAkB;AAClB,SAAS,QAAQ,OAAO;AACtB,QAAM,mBAAmB,KAAK,UAAU;AAAA,IACtC,OAAO,MAAM;AAAA,IACb,WAAW,MAAM;AAAA,EACnB,CAAC;AACD,QAAM,KAAK,aAAAA,QAAM;AAAA,IACf,MAAM,cAAc,gBAAgB;AAAA,IACpC,CAAC,gBAAgB;AAAA,EACnB;AACA,QAAM,gBAAgB,aAAAA,QAAM,QAAQ,MAAM;AACxC,QAAI,MAAM,MAAM;AACd,YAAM,WAAW,KAAK,MAAM,KAAK,UAAU,MAAM,IAAI,CAAC;AACtD,aAAO,YAAY,IAAI,UAAU,CAAC,CAAC;AAAA,IACrC;AAAA,EACF,GAAG,CAAC,MAAM,MAAM,EAAE,CAAC;AACnB,QAAM,CAAC,MAAM,OAAO,IAAI,aAAAA,QAAM,SAAS,aAAa;AACpD,QAAM,CAAC,UAAU,WAAW,IAAI,aAAAA,QAAM,SAAS,KAAK;AACpD,QAAM,CAAC,kBAAkB,mBAAmB,IAAI,aAAAA,QAAM,SAAS,KAAK;AACpE,QAAM,CAAC,gBAAgB,iBAAiB,IAAI,aAAAA,QAAM,SAAS,KAAK;AAChE,eAAAA,QAAM,UAAU,MAAM;AACpB,gBAAY,IAAI;AAChB,YAAQ,aAAa;AACrB,WAAO,YAAY;AAAA,MACjB,MAAM;AAAA,IACR,CAAC;AAAA,EACH,GAAG,CAAC,IAAI,aAAa,CAAC;AACtB,eAAAA,QAAM,UAAU,MAAM;AACpB,QAAI,kBAAkB;AACpB,UAAI,mBAAmB,SAAS,GAAG;AACjC,cAAM,iBAAiB,EAAE,OAAO,kBAAkB;AAClD,cAAM,gBAAgB,eAAe;AAAA,UACnC,CAAC,SAAS,KAAK,WAAW,iBAAiB;AAAA,QAC7C;AACA,YAAI;AACJ,YAAI,eAAe;AACjB,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAClB,sBAAY,EAAE,OAAO,aAAa,aAAa;AAAA,QACjD,OAAO;AACL,gBAAM,WAAW,EAAE,OAAO;AAAA,YACxB;AAAA,UACF;AACA,cAAI,UAAU;AACZ,kBAAM,kBAAkB,SAAS,kBAAkB;AACnD,kBAAM,iBAAiB,gBAAgB;AAAA,cACrC,CAAC,SAAS,KAAK,WAAW,iBAAiB;AAAA,YAC7C;AACA,gBAAI,gBAAgB;AAClB,gBAAE,eAAe;AACjB,gBAAE,gBAAgB;AAClB,0BAAY,SAAS,aAAa,cAAc;AAAA,YAClD;AAAA,UACF;AAAA,QACF;AACA,YAAI,WAAW;AACb,cAAI,gBAAgB;AAClB,mBAAO;AAAA,cACL,EAAE,MAAM,kBAAkB,UAAU;AAAA,cACpC,OAAO,SAAS;AAAA,YAClB;AAAA,UACF;AAAA,QACF;AAAA,MACF;AACA,YAAM,QAAQ,SAAS,cAAc,OAAO;AAC5C,YAAM,OAAO;AACb,YAAM,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA+BpB,eAAS,KAAK,YAAY,KAAK;AAC/B,eAAS,KAAK,UAAU,IAAI,8BAA8B;AAC1D,eAAS,iBAAiB,SAAS,kBAAkB,IAAI;AACzD,aAAO,MAAM;AACX,iBAAS,oBAAoB,SAAS,kBAAkB,IAAI;AAC5D,iBAAS,KAAK,UAAU,OAAO,8BAA8B;AAC7D,cAAM,OAAO;AAAA,MACf;AAAA,IACF;AAAA,EACF,GAAG,CAAC,kBAAkB,cAAc,CAAC;AACrC,eAAAA,QAAM,UAAU,MAAM;AACpB,QAAI,SAAS,OAAO,SAAS,MAAM,mCAAmC;AACpE,aAAO,YAAY;AAAA,QACjB,MAAM;AAAA,QACN,QAAQ,MAAM,kCAAkC;AAAA,MAClD,CAAC;AAAA,IACH;AAAA,EACF,GAAG,CAAC,EAAE,CAAC;AACP,eAAAA,QAAM,UAAU,MAAM;AACpB,UAAM,EAAE,mCAAmC,GAAG,KAAK,IAAI;AACvD,WAAO,YAAY,EAAE,MAAM,QAAQ,GAAG,MAAM,GAAG,GAAG,OAAO,SAAS,MAAM;AACxE,UAAM,gBAAgB,CAAC,UAAU;AAC/B,UAAI,MAAM,KAAK,SAAS,oBAAoB;AAC1C,4BAAoB,MAAM,KAAK,KAAK;AAAA,MACtC;AACA,UAAI,MAAM,KAAK,OAAO,MAAM,MAAM,KAAK,SAAS,cAAc;AAC5D,cAAM,UAAU,MAAM,KAAK;AAC3B,cAAM,qBAAqB;AAAA,UACzB;AAAA,UACA,KAAK,MAAM,KAAK,UAAU,OAAO,CAAC;AAAA,UAClC,CAAC;AAAA,QACH;AACA,gBAAQ,kBAAkB;AAC1B,0BAAkB,IAAI;AACtB,cAAM,eAAe,SAAS,cAAc,mBAAmB;AAC/D,YAAI,cAAc;AAChB,iBAAO;AAAA,YACL,EAAE,MAAM,cAAc,OAAO,KAAK;AAAA,YAClC,OAAO,SAAS;AAAA,UAClB;AAAA,QACF,OAAO;AACL,iBAAO;AAAA,YACL,EAAE,MAAM,cAAc,OAAO,MAAM;AAAA,YACnC,OAAO,SAAS;AAAA,UAClB;AAAA,QACF;AAAA,MACF;AAAA,IACF;AACA,WAAO,iBAAiB,WAAW,aAAa;AAChD,WAAO,MAAM;AACX,aAAO,oBAAoB,WAAW,aAAa;AACnD,aAAO,YAAY,EAAE,MAAM,SAAS,GAAG,GAAG,OAAO,SAAS,MAAM;AAAA,IAClE;AAAA,EACF,GAAG,CAAC,IAAI,mBAAmB,CAAC;AAC5B,SAAO,EAAE,MAAM,SAAS;AAC1B;AACA,SAAS,eAAe;AACtB,QAAM,CAAC,MAAM,OAAO,IAAI,aAAAA,QAAM,SAAS,KAAK;AAC5C,eAAAA,QAAM,UAAU,MAAM;AACpB,QAAI,OAAO,WAAW,aAAa;AACjC,aAAO,YAAY,EAAE,MAAM,aAAa,GAAG,OAAO,SAAS,MAAM;AACjE,aAAO,iBAAiB,WAAW,CAAC,UAAU;AAC5C,YAAI;AACJ,cAAM,KAAK,MAAM,SAAS,OAAO,SAAS,GAAG,UAAU,iBAAiB;AACtE,kBAAQ,IAAI;AAAA,QACd;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EACF,GAAG,CAAC,CAAC;AACL,SAAO,EAAE,KAAK;AAChB;AACA,IAAM,YAAY,CAAC,QAAQ,UAAU,UAAU;AAC7C,QAAM,gBAAgB,UAAU,OAAO,SAAS,OAAO;AACvD,MAAI,CAAC,eAAe;AAClB,WAAO;AAAA,EACT;AACA,QAAM,EAAE,SAAS,KAAK,IAAI;AAC1B,MAAI,CAAC,UAAU;AACb,WAAO,GAAG,OAAO,MAAM,KAAK,KAAK,GAAG,CAAC;AAAA,EACvC;AACA,QAAM,WAAW,OAAO,UAAU,WAAW,CAAC,GAAG,MAAM,UAAU,KAAK,IAAI,CAAC,GAAG,MAAM,QAAQ;AAC5F,SAAO,GAAG,OAAO,MAAM,SAAS,KAAK,GAAG,CAAC;AAC3C;AACA,IAAM,cAAc,CAAC,IAAI,KAAK,OAAO,CAAC,MAAM;AAC1C,MAAI,QAAQ,MAAM;AAChB,WAAO;AAAA,EACT;AACA,MAAI,oBAAoB,GAAG,GAAG;AAC5B,WAAO;AAAA,EACT;AACA,MAAI,eAAe,QAAQ;AACzB,WAAO,IAAI,QAAQ;AAAA,EACrB;AACA,MAAI,MAAM,QAAQ,GAAG,GAAG;AACtB,WAAO,IAAI;AAAA,MACT,CAAC,MAAM,UAAU,YAAY,IAAI,MAAM,CAAC,GAAG,MAAM,KAAK,CAAC;AAAA,IACzD;AAAA,EACF;AACA,QAAM,iBAAiB,CAAC;AACxB,aAAW,CAAC,KAAK,KAAK,KAAK,OAAO,QAAQ,GAAG,GAAG;AAC9C,UAAM,cAAc,CAAC,GAAG,MAAM,GAAG;AACjC,QAAI;AAAA,MACF;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACF,EAAE,SAAS,GAAG,GAAG;AACf,qBAAe,GAAG,IAAI;AAAA,IACxB,OAAO;AACL,qBAAe,GAAG,IAAI,YAAY,IAAI,OAAO,WAAW;AAAA,IAC1D;AAAA,EACF;AACA,MAAI,kBAAkB,OAAO,mBAAmB,YAAY,UAAU,kBAAkB,eAAe,SAAS,QAAQ;AACtH,WAAO;AAAA,EACT;AACA,SAAO,EAAE,GAAG,gBAAgB,iBAAiB,EAAE,SAAS,IAAI,KAAK,EAAE;AACrE;AACA,SAAS,oBAAoB,OAAO;AAClC,QAAM,OAAO,OAAO;AACpB,MAAI,SAAS;AACX,WAAO;AACT,MAAI,SAAS;AACX,WAAO;AACT,MAAI,SAAS;AACX,WAAO;AACT,MAAI,SAAS;AACX,WAAO;AACT,MAAI,SAAS;AACX,WAAO;AACT,MAAI,iBAAiB;AACnB,WAAO;AACT,MAAI,iBAAiB;AACnB,WAAO;AACT,MAAI,iBAAiB;AACnB,WAAO;AACT,SAAO;AACT;AACA,IAAM,gBAAgB,CAAC,UAAU;AAC/B,MAAI,OAAO;AACX,WAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AACrC,UAAM,OAAO,MAAM,WAAW,CAAC;AAC/B,YAAQ,QAAQ,KAAK,OAAO,OAAO;AAAA,EACrC;AACA,QAAM,kBAAkB,KAAK,IAAI,IAAI;AACrC,QAAM,mBAAmB,gBAAgB,SAAS,EAAE;AACpD,SAAO;AACT;",
  "names": ["React"]
}
